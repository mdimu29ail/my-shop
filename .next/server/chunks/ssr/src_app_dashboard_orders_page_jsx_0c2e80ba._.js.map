{"version":3,"sources":["turbopack:///[project]/src/app/dashboard/orders/page.jsx"],"sourcesContent":["'use client';\r\nimport { useEffect, useState } from 'react';\r\nimport { useSession } from 'next-auth/react';\r\nimport Swal from 'sweetalert2';\r\n\r\nexport default function OrdersPage() {\r\n  const { data: session, status } = useSession();\r\n  const [orders, setOrders] = useState([]);\r\n\r\n  const fetchOrders = async () => {\r\n    if (!session) return;\r\n\r\n    try {\r\n      // Fetch only orders for the logged-in user\r\n      const res = await fetch(`/api/orders?email=${session.user.email}`);\r\n      const data = await res.json();\r\n      if (Array.isArray(data)) setOrders(data);\r\n      else setOrders([]);\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (status === 'authenticated') fetchOrders();\r\n  }, [status, session]);\r\n\r\n  const handleDelete = async id => {\r\n    const confirm = await Swal.fire({\r\n      title: 'Are you sure?',\r\n      text: \"You won't be able to revert this!\",\r\n      icon: 'warning',\r\n      showCancelButton: true,\r\n      confirmButtonColor: '#d33',\r\n      cancelButtonColor: '#3085d6',\r\n      confirmButtonText: 'Yes, delete it!',\r\n    });\r\n\r\n    if (confirm.isConfirmed) {\r\n      try {\r\n        const res = await fetch(`/api/orders/${id}`, {\r\n          method: 'DELETE',\r\n        });\r\n\r\n        const result = await res.json();\r\n\r\n        if (res.ok) {\r\n          Swal.fire('Deleted!', result.message, 'success');\r\n          fetchOrders(); // Refresh orders list\r\n        } else {\r\n          Swal.fire('Error', result.message || 'Failed to delete', 'error');\r\n        }\r\n      } catch (err) {\r\n        Swal.fire('Error', err.message, 'error');\r\n      }\r\n    }\r\n  };\r\n\r\n  if (status === 'loading') return <p>Loading...</p>;\r\n  if (!session) return <p>Please login to see your orders.</p>;\r\n\r\n  return (\r\n    <div className=\" mx-auto p-8 bg-[#F8EFBA] text-black\">\r\n      <h1 className=\"text-3xl font-bold mb-6 text-orange-500\">My Orders</h1>\r\n      {orders.length === 0 ? (\r\n        <p>No orders yet.</p>\r\n      ) : (\r\n        <div className=\"space-y-4\">\r\n          {orders.map(order => (\r\n            <div\r\n              key={order._id}\r\n              className=\"p-4 border rounded shadow flex justify-between items-center\"\r\n            >\r\n              <div>\r\n                <p>\r\n                  <strong>Product:</strong> {order.productName}\r\n                </p>\r\n                <p>\r\n                  <strong>Price:</strong> ${order.price}\r\n                </p>\r\n                <p>\r\n                  <strong>User:</strong> {order.userName}\r\n                </p>\r\n                <p>\r\n                  <strong>Email:</strong> {order.userEmail}\r\n                </p>\r\n              </div>\r\n              <button\r\n                onClick={() => handleDelete(order._id)}\r\n                className=\"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600\"\r\n              >\r\n                Delete\r\n              </button>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"8EACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEe,SAAS,IACtB,GAAM,CAAE,KAAM,CAAO,QAAE,CAAM,CAAE,CAAG,CAAA,EAAA,EAAA,UAAA,AAAU,IACtC,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAE,EAEjC,EAAc,UAClB,GAAK,CAAD,CAEJ,GAAI,CAEF,GAJY,CAIN,EAAM,MAAM,MAAM,CAAC,kBAAkB,EAAE,EAAQ,IAAI,CAAC,KAAK,CAAA,CAAE,EAC3D,EAAO,MAAM,EAAI,IAAI,GACvB,MAAM,OAAO,CAAC,GAAO,EAAU,GAC9B,EAAU,EAAE,CACnB,CAAE,MAAO,EAAK,CACZ,QAAQ,KAAK,CAAC,EAChB,CACF,EAEA,CAAA,EAAA,EAAA,SAAS,AAAT,EAAU,KACO,kBAAX,GAA4B,GAClC,EAAG,CAAC,EAAQ,EAAQ,EAEpB,IAAM,EAAe,MAAM,IAWzB,GAAI,CAVY,MAAM,EAAA,OAAI,CAAC,IAAI,CAAC,CAC9B,MAAO,gBACP,KAAM,oCACN,KAAM,UACN,kBAAkB,EAClB,mBAAoB,OACpB,kBAAmB,UACnB,kBAAmB,iBACrB,EAAA,EAEY,WAAW,CACrB,CADuB,EACnB,CACF,IAAM,EAAM,MAAM,MAAM,CAAC,YAAY,EAAE,EAAA,CAAI,CAAE,CAC3C,OAAQ,QACV,GAEM,EAAS,MAAM,EAAI,IAAI,GAEzB,EAAI,EAAE,EAAE,AACV,EAAA,OAAI,CAAC,IAAI,CAAC,WAAY,EAAO,OAAO,CAAE,WACtC,KAEA,EAAA,OAAI,CAAC,AAFU,IAEN,CAAC,QAAS,EAAO,OAFW,AAEJ,EAAI,mBAAoB,QAE7D,CAAE,MAAO,EAAK,CACZ,EAAA,OAAI,CAAC,IAAI,CAAC,QAAS,EAAI,OAAO,CAAE,QAClC,CAEJ,QAEA,AAAe,WAAW,CAAtB,EAA6B,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,eAC/B,EAGH,CAAA,EAAA,EAAA,EAHY,EAGZ,EAAC,MAAA,CAAI,UAAU,iDACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,mDAA0C,cACrC,IAAlB,EAAO,MAAM,CACZ,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,mBAEH,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACZ,EAAO,GAAG,CAAC,GACV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEC,UAAU,wEAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,aAAiB,IAAE,EAAM,WAAW,IAE9C,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,WAAe,KAAG,EAAM,KAAK,IAEvC,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,UAAc,IAAE,EAAM,QAAQ,IAExC,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,WAAe,IAAE,EAAM,SAAS,OAG5C,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAa,EAAM,GAAG,EACrC,UAAU,oEACX,aApBI,EAAM,GAAG,QAXL,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,oCAwC1B"}